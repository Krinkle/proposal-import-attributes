<!doctype html>
<head><meta charset="utf-8">
<script src="ecmarkup.js"></script>
<link rel="stylesheet" href="ecmarkup.css">
<title>import assertions</title>
<script type="application/json" id="menu-search-biblio">[{"type":"clause","id":"intro","aoid":null,"title":"import assertions","titleHTML":"import assertions","number":"","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","referencingIds":[],"key":"import assertions"},{"type":"production","id":"prod-ImportDeclaration","name":"ImportDeclaration","referencingIds":["_ref_85","_ref_86"],"namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"ImportDeclaration"},{"type":"production","id":"prod-ExportDeclaration","name":"ExportDeclaration","referencingIds":[],"namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"ExportDeclaration"},{"type":"production","id":"prod-AssertClause","name":"AssertClause","referencingIds":["_ref_66","_ref_67","_ref_68","_ref_73","_ref_76","_ref_87","_ref_88","_ref_95","_ref_96"],"namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"AssertClause"},{"type":"production","id":"prod-AssertEntries","name":"AssertEntries","referencingIds":["_ref_69","_ref_72","_ref_75","_ref_77","_ref_78","_ref_82","_ref_84"],"namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"AssertEntries"},{"type":"production","id":"prod-AssertionKey","name":"AssertionKey","referencingIds":["_ref_70","_ref_71","_ref_79","_ref_80","_ref_81","_ref_83"],"namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"AssertionKey"},{"type":"production","id":"prod-ImportCall","name":"ImportCall","referencingIds":["_ref_74"],"namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"ImportCall"},{"type":"clause","id":"sec-syntax","aoid":null,"title":"Syntax","titleHTML":"Syntax","number":"1","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","referencingIds":[],"key":"Syntax"},{"type":"clause","id":"sec-import-call-runtime-semantics-evaluation","aoid":null,"title":"Runtime Semantics: Evaluation","titleHTML":"Runtime Semantics: Evaluation","number":"2.1.1","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","referencingIds":[],"key":"Runtime Semantics: Evaluation"},{"type":"clause","id":"sec-import-calls","aoid":null,"title":"Import Calls","titleHTML":"Import Calls","number":"2.1","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","referencingIds":["_ref_0","_ref_1","_ref_2","_ref_3"],"key":"Import Calls"},{"type":"op","aoid":"HostResolveImportedModule","refId":"sec-hostresolveimportedmodule","location":"","referencingIds":[],"key":"HostResolveImportedModule"},{"type":"clause","id":"sec-hostresolveimportedmodule","aoid":"HostResolveImportedModule","title":"Runtime Semantics: HostResolveImportedModule ( referencingScriptOrModule, specifier moduleRequest )","titleHTML":"Runtime Semantics: HostResolveImportedModule ( <var>referencingScriptOrModule</var>, <del><var>specifier</var></del> <ins><var>moduleRequest</var></ins> )","number":"2.2","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","referencingIds":["_ref_30","_ref_32","_ref_36","_ref_37","_ref_41","_ref_62"],"key":"Runtime Semantics: HostResolveImportedModule ( referencingScriptOrModule, specifier moduleRequest )"},{"type":"op","aoid":"HostImportModuleDynamically","refId":"sec-hostimportmoduledynamically","location":"","referencingIds":[],"key":"HostImportModuleDynamically"},{"type":"clause","id":"sec-hostimportmoduledynamically","aoid":"HostImportModuleDynamically","title":"Runtime Semantics: HostImportModuleDynamically ( referencingScriptOrModule, specifier, moduleRequest, promiseCapability )","titleHTML":"Runtime Semantics: HostImportModuleDynamically ( <var>referencingScriptOrModule</var>, <del><var>specifier</var>,<del> <ins><var>moduleRequest</var>,</ins> <var>promiseCapability</var> )</del></del>","number":"2.3","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","referencingIds":["_ref_11","_ref_24","_ref_39","_ref_63"],"key":"Runtime Semantics: HostImportModuleDynamically ( referencingScriptOrModule, specifier, moduleRequest, promiseCapability )"},{"type":"op","aoid":"FinishDynamicImport","refId":"sec-finishdynamicimport","location":"","referencingIds":[],"key":"FinishDynamicImport"},{"type":"clause","id":"sec-finishdynamicimport","aoid":"FinishDynamicImport","title":"Runtime Semantics: FinishDynamicImport ( referencingScriptOrModule, specifier, moduleRequest, promiseCapability, completion )","titleHTML":"Runtime Semantics: FinishDynamicImport ( <var>referencingScriptOrModule</var>, <del><var>specifier</var>,</del> <ins><var>moduleRequest</var>,</ins> <var>promiseCapability</var>, <var>completion</var> )","number":"2.4","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","referencingIds":["_ref_27","_ref_28","_ref_31","_ref_33","_ref_34","_ref_35"],"key":"Runtime Semantics: FinishDynamicImport ( referencingScriptOrModule, specifier, moduleRequest, promiseCapability, completion )"},{"type":"clause","id":"sec-assert-clause-early-errors","aoid":null,"title":"Static Semantics: Early Errors","titleHTML":"Static Semantics: Early Errors","number":"2.5","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","referencingIds":[],"key":"Static Semantics: Early Errors"},{"type":"op","aoid":"AssertClauseToAssertions","refId":"sec-assert-clause-to-assertions","location":"","referencingIds":[],"key":"AssertClauseToAssertions"},{"type":"clause","id":"sec-assert-clause-to-assertions","aoid":"AssertClauseToAssertions","title":"Runtime Semantics: AssertClauseToAssertions","titleHTML":"Runtime Semantics: AssertClauseToAssertions","number":"2.6","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","referencingIds":["_ref_45","_ref_46","_ref_47","_ref_48","_ref_49","_ref_57","_ref_60"],"key":"Runtime Semantics: AssertClauseToAssertions"},{"type":"term","term":"ModuleRequest Record","refId":"sec-modulerequest-record","referencingIds":[],"namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"ModuleRequest Record"},{"type":"table","id":"table-cyclic-module-fields","number":1,"caption":"Table 1: ModuleRequest Record fields","referencingIds":[],"namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"Table 1: ModuleRequest Record fields"},{"type":"clause","id":"sec-modulerequest-record","aoid":null,"title":"ModuleRequest Records","titleHTML":"ModuleRequest Records","number":"2.7","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","referencingIds":["_ref_10","_ref_23","_ref_25","_ref_26","_ref_38","_ref_50","_ref_51","_ref_54","_ref_55","_ref_56","_ref_58","_ref_59","_ref_61","_ref_64","_ref_65"],"key":"ModuleRequest Records"},{"type":"table","id":"table-cyclic-module-fields","number":2,"caption":"Table 2: Additional Fields of Cyclic Module Records","referencingIds":[],"namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"Table 2: Additional Fields of Cyclic Module Records"},{"type":"term","term":"ImportEntry Record","refId":"sec-semantics","referencingIds":["_ref_52","_ref_53"],"id":"importentry-record","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"ImportEntry Record"},{"type":"table","id":"table-39","number":3,"caption":"Table 3: ImportEntry Record Fields","referencingIds":["_ref_4"],"namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"Table 3: ImportEntry Record Fields"},{"type":"production","id":"prod-Module","name":"Module","referencingIds":[],"namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"Module"},{"type":"production","id":"prod-ModuleItemList","name":"ModuleItemList","referencingIds":["_ref_91","_ref_93"],"namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"ModuleItemList"},{"type":"production","id":"prod-ModuleItem","name":"ModuleItem","referencingIds":["_ref_89","_ref_90","_ref_92","_ref_94"],"namespace":"https://github.com/tc39/proposal-import-assertions","location":"","key":"ModuleItem"},{"type":"clause","id":"sec-static-semantics-modulerequests","aoid":null,"title":"Static Semantics: ModuleRequests","titleHTML":"Static Semantics: ModuleRequests","number":"2.8","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","referencingIds":[],"key":"Static Semantics: ModuleRequests"},{"type":"clause","id":"sec-semantics","aoid":null,"title":"Semantics","titleHTML":"Semantics","number":"2","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","referencingIds":[],"key":"Semantics"},{"type":"clause","id":"sec-host-integration","aoid":null,"title":"Sample host integration: The Web embedding","titleHTML":"Sample host integration: The Web embedding","number":"A","namespace":"https://github.com/tc39/proposal-import-assertions","location":"","referencingIds":[],"key":"Sample host integration: The Web embedding"}]</script></head><body><div id="menu-toggle">☰</div><div id="menu-spacer"></div><div id="menu"><div id="menu-search"><input type="text" id="menu-search-box" placeholder="Search..."><div id="menu-search-results" class="inactive"></div></div><div id="menu-pins"><div class="menu-pane-header">Pins</div><ul id="menu-pins-list"></ul></div><div class="menu-pane-header">Table of Contents</div><div id="menu-toc"><ol class="toc"><li><span class="item-toggle-none"></span><a href="#intro" title="import assertions">import assertions</a></li><li><span class="item-toggle-none"></span><a href="#sec-syntax" title="Syntax"><span class="secnum">1</span> Syntax</a></li><li><span class="item-toggle">◢</span><a href="#sec-semantics" title="Semantics"><span class="secnum">2</span> Semantics</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#sec-import-calls" title="Import Calls"><span class="secnum">2.1</span> Import Calls</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-import-call-runtime-semantics-evaluation" title="Runtime Semantics: Evaluation"><span class="secnum">2.1.1</span> RS: Evaluation</a></li></ol></li><li><span class="item-toggle-none"></span><a href="#sec-hostresolveimportedmodule" title="Runtime Semantics: HostResolveImportedModule ( referencingScriptOrModule, specifier moduleRequest )"><span class="secnum">2.2</span> RS: HostResolveImportedModule ( <var>referencingScriptOrModule</var>, <del><var>specifier</var></del> <ins><var>moduleRequest</var></ins> )</a></li><li><span class="item-toggle-none"></span><a href="#sec-hostimportmoduledynamically" title="Runtime Semantics: HostImportModuleDynamically ( referencingScriptOrModule, specifier, moduleRequest, promiseCapability )"><span class="secnum">2.3</span> RS: HostImportModuleDynamically ( <var>referencingScriptOrModule</var>, <del><var>specifier</var>,<del> <ins><var>moduleRequest</var>,</ins> <var>promiseCapability</var> )</del></del></a></li><li><span class="item-toggle-none"></span><a href="#sec-finishdynamicimport" title="Runtime Semantics: FinishDynamicImport ( referencingScriptOrModule, specifier, moduleRequest, promiseCapability, completion )"><span class="secnum">2.4</span> RS: FinishDynamicImport ( <var>referencingScriptOrModule</var>, <del><var>specifier</var>,</del> <ins><var>moduleRequest</var>,</ins> <var>promiseCapability</var>, <var>completion</var> )</a></li><li><span class="item-toggle-none"></span><a href="#sec-assert-clause-early-errors" title="Static Semantics: Early Errors"><span class="secnum">2.5</span> SS: Early Errors</a></li><li><span class="item-toggle-none"></span><a href="#sec-assert-clause-to-assertions" title="Runtime Semantics: AssertClauseToAssertions"><span class="secnum">2.6</span> RS: AssertClauseToAssertions</a></li><li><span class="item-toggle-none"></span><a href="#sec-modulerequest-record" title="ModuleRequest Records"><span class="secnum">2.7</span> ModuleRequest Records</a></li><li><span class="item-toggle-none"></span><a href="#sec-static-semantics-modulerequests" title="Static Semantics: ModuleRequests"><span class="secnum">2.8</span> SS: ModuleRequests</a></li></ol></li><li><span class="item-toggle-none"></span><a href="#sec-host-integration" title="Sample host integration: The Web embedding"><span class="secnum">A</span> Sample host integration: The Web embedding</a></li></ol></div></div><div id="spec-container"><h1 class="version first">Stage 2 Draft / September 3, 2020</h1>
<emu-intro id="intro">
  <h1>import assertions</h1>
  <p>See <a href="https://github.com/tc39/proposal-import-assertions/blob/master/README.md">the explainer</a> for information.</p>
</emu-intro>

<emu-clause id="sec-syntax">
  <h1><span class="secnum">1</span> Syntax</h1>

  <emu-grammar><emu-production name="ImportDeclaration" id="prod-ImportDeclaration">
    <emu-nt><a href="#prod-ImportDeclaration">ImportDeclaration</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="1a51d4c5"><emu-t>import</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-ImportClause">ImportClause</a></emu-nt><emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt><emu-t>;</emu-t></emu-rhs>
    <emu-rhs a="a1d094cc"><emu-t>import</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-ModuleSpecifier">ModuleSpecifier</a></emu-nt><emu-t>;</emu-t></emu-rhs>
    <ins><emu-rhs a="951c37e6"><emu-t>import</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-ImportClause">ImportClause</a></emu-nt><emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt><emu-gann>[no <emu-nt><a href="https://tc39.es/ecma262/#prod-LineTerminator">LineTerminator</a></emu-nt> here]</emu-gann><emu-nt id="_ref_66"><a href="#prod-AssertClause">AssertClause</a></emu-nt><emu-t>;</emu-t></emu-rhs></ins>
    <ins><emu-rhs a="8edd0b8a"><emu-t>import</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-ModuleSpecifier">ModuleSpecifier</a></emu-nt><emu-gann>[no <emu-nt><a href="https://tc39.es/ecma262/#prod-LineTerminator">LineTerminator</a></emu-nt> here]</emu-gann><emu-nt id="_ref_67"><a href="#prod-AssertClause">AssertClause</a></emu-nt><emu-t>;</emu-t></emu-rhs></ins>
</emu-production>
<emu-production name="ExportDeclaration" id="prod-ExportDeclaration">
    <emu-nt><a href="#prod-ExportDeclaration">ExportDeclaration</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="e0a40575"><emu-t>export</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-ExportFromClause">ExportFromClause</a></emu-nt><emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt><emu-t>;</emu-t></emu-rhs>
    <ins><emu-rhs a="ab582cf0"><emu-t>export</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-ExportFromClause">ExportFromClause</a></emu-nt><emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt><emu-gann>[no <emu-nt><a href="https://tc39.es/ecma262/#prod-LineTerminator">LineTerminator</a></emu-nt> here]</emu-gann><emu-nt id="_ref_68"><a href="#prod-AssertClause">AssertClause</a></emu-nt><emu-t>;</emu-t></emu-rhs></ins>
    <emu-rhs a="2762c7fe"><emu-t>export</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-NamedExports">NamedExports</a></emu-nt><emu-t>;</emu-t></emu-rhs>
    <emu-rhs a="696b8d6e"><emu-t>export</emu-t><emu-nt params="~Yield, ~Await"><a href="https://tc39.es/ecma262/#prod-VariableStatement">VariableStatement</a><emu-mods><emu-params>[~Yield, ~Await]</emu-params></emu-mods></emu-nt></emu-rhs>
    <emu-rhs a="6bc99b97"><emu-t>export</emu-t><emu-nt params="~Yield, ~Await"><a href="https://tc39.es/ecma262/#prod-Declaration">Declaration</a><emu-mods><emu-params>[~Yield, ~Await]</emu-params></emu-mods></emu-nt></emu-rhs>
    <emu-rhs a="d298e1ba"><emu-t>export</emu-t><emu-t>default</emu-t><emu-nt params="~Yield, ~Await, +Default"><a href="https://tc39.es/ecma262/#prod-HoistableDeclaration">HoistableDeclaration</a><emu-mods><emu-params>[~Yield, ~Await, +Default]</emu-params></emu-mods></emu-nt></emu-rhs>
    <emu-rhs a="ae276654"><emu-t>export</emu-t><emu-t>default</emu-t><emu-nt params="~Yield, ~Await, +Default"><a href="https://tc39.es/ecma262/#prod-ClassDeclaration">ClassDeclaration</a><emu-mods><emu-params>[~Yield, ~Await, +Default]</emu-params></emu-mods></emu-nt></emu-rhs>
    <emu-rhs a="e2a585b6"><emu-t>export</emu-t><emu-t>default</emu-t><emu-gann>[lookahead ∉ { <emu-t>function</emu-t>, <emu-t>async</emu-t>
        <emu-gann>[no <emu-nt><a href="https://tc39.es/ecma262/#prod-LineTerminator">LineTerminator</a></emu-nt> here]</emu-gann>
        <emu-t>function</emu-t>, <emu-t>class</emu-t> }]</emu-gann><emu-nt params="+In, ~Yield, ~Await"><a href="https://tc39.es/ecma262/#prod-AssignmentExpression">AssignmentExpression</a><emu-mods><emu-params>[+In, ~Yield, ~Await]</emu-params></emu-mods></emu-nt><emu-t>;</emu-t></emu-rhs>
</emu-production>
<emu-production name="AssertClause" id="prod-AssertClause">
    <emu-nt><a href="#prod-AssertClause">AssertClause</a></emu-nt><emu-geq>:</emu-geq><ins><emu-rhs a="89f92a71"><emu-t>assert</emu-t><emu-t>{</emu-t><emu-nt id="_ref_69"><a href="#prod-AssertEntries">AssertEntries</a></emu-nt><emu-t optional="">,<emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-t><emu-t>}</emu-t></emu-rhs>
    </ins>
</emu-production>
<emu-production name="AssertEntries" id="prod-AssertEntries">
    <emu-nt><a href="#prod-AssertEntries">AssertEntries</a></emu-nt><emu-geq>:</emu-geq><ins><emu-rhs a="4aef607e"><emu-nt id="_ref_70"><a href="#prod-AssertionKey">AssertionKey</a></emu-nt><emu-t>:</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-StringLiteral">StringLiteral</a></emu-nt></emu-rhs></ins>
    <ins><emu-rhs a="2e83f2a2"><emu-nt id="_ref_71"><a href="#prod-AssertionKey">AssertionKey</a></emu-nt><emu-t>:</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-StringLiteral">StringLiteral</a></emu-nt><emu-t>,</emu-t><emu-nt id="_ref_72"><a href="#prod-AssertEntries">AssertEntries</a></emu-nt></emu-rhs></ins>
</emu-production>
<emu-production name="AssertionKey" id="prod-AssertionKey">
    <emu-nt><a href="#prod-AssertionKey">AssertionKey</a></emu-nt><emu-geq>:</emu-geq><ins><emu-rhs a="0ebb31e2"><emu-nt><a href="https://tc39.es/ecma262/#prod-IdentifierName">IdentifierName</a></emu-nt></emu-rhs></ins>
    <ins><emu-rhs a="5c74e54d"><emu-nt><a href="https://tc39.es/ecma262/#prod-StringLiteral">StringLiteral</a></emu-nt></emu-rhs></ins>
</emu-production>
<emu-production name="ImportCall" params="Yield, Await" id="prod-ImportCall">
    <emu-nt params="Yield, Await"><a href="#prod-ImportCall">ImportCall</a><emu-mods><emu-params>[Yield, Await]</emu-params></emu-mods></emu-nt><emu-geq>:</emu-geq><emu-rhs a="9710d64c"><emu-t>import</emu-t><emu-t>(</emu-t><emu-nt params="+In, ?Yield, ?Await"><a href="https://tc39.es/ecma262/#prod-AssignmentExpression">AssignmentExpression</a><emu-mods><emu-params>[+In, ?Yield, ?Await]</emu-params></emu-mods></emu-nt><ins><emu-t optional="">,<emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-t></ins><emu-t>)</emu-t></emu-rhs>
    <ins><emu-rhs a="571c9520"><emu-t>import</emu-t><emu-t>(</emu-t><emu-nt params="+In, ?Yield, ?Await"><a href="https://tc39.es/ecma262/#prod-AssignmentExpression">AssignmentExpression</a><emu-mods><emu-params>[+In, ?Yield, ?Await]</emu-params></emu-mods></emu-nt><emu-t>,</emu-t><emu-nt params="+In, ?Yield, ?Await"><a href="https://tc39.es/ecma262/#prod-AssignmentExpression">AssignmentExpression</a><emu-mods><emu-params>[+In, ?Yield, ?Await]</emu-params></emu-mods></emu-nt><emu-t optional="">,<emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-t><emu-t>)</emu-t></emu-rhs></ins>
</emu-production></emu-grammar>
</emu-clause>

<emu-clause id="sec-semantics">
  <h1><span class="secnum">2</span> Semantics</h1>

  <emu-note type="editor"><span class="note">Editor's Note</span><div class="note-contents"><p>Many productions operating on grammar are the same whether or not an <emu-nt id="_ref_73"><a href="#prod-AssertClause">AssertClause</a></emu-nt>/second <emu-nt id="_ref_74"><a href="#prod-ImportCall">ImportCall</a></emu-nt> parameter is included; the new parameter is ignored. In this section, only the semantically significant changes are included, and the PR to merge into the main specification would fill in the straightforward details.</p></div></emu-note>

    <emu-clause id="sec-import-calls">
      <h1><span class="secnum">2.1</span> Import Calls</h1>

      <emu-clause id="sec-import-call-runtime-semantics-evaluation">
        <h1><span class="secnum">2.1.1</span> Runtime Semantics: Evaluation</h1>

        <emu-grammar><emu-production name="ImportCall" collapsed="">
    <emu-nt><a href="#prod-ImportCall">ImportCall</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="44ab2e9a"><emu-t>import</emu-t><emu-t>(</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-AssignmentExpression">AssignmentExpression</a></emu-nt><emu-t optional="">,<emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-t><emu-t>)</emu-t></emu-rhs>
</emu-production></emu-grammar>
        <emu-alg><ol><li>Let <var>referencingScriptOrModule</var> be !&nbsp;<emu-xref aoid="GetActiveScriptOrModule" id="_ref_5"><a href="https://tc39.es/ecma262/#sec-getactivescriptormodule">GetActiveScriptOrModule</a></emu-xref>().</li><li>Let <var>argRef</var> be the result of evaluating <emu-nt><a href="https://tc39.es/ecma262/#prod-AssignmentExpression">AssignmentExpression</a></emu-nt>.</li><li>Let <var>specifier</var> be ?&nbsp;<emu-xref aoid="GetValue" id="_ref_6"><a href="https://tc39.es/ecma262/#sec-getvalue">GetValue</a></emu-xref>(<var>argRef</var>).</li><li>Let <var>promiseCapability</var> be !&nbsp;<emu-xref aoid="NewPromiseCapability" id="_ref_7"><a href="https://tc39.es/ecma262/#sec-newpromisecapability">NewPromiseCapability</a></emu-xref>(<emu-xref href="#sec-promise-constructor"><a href="https://tc39.es/ecma262/#sec-promise-constructor">%Promise%</a></emu-xref>).</li><li>Let <var>specifierString</var> be <emu-xref aoid="ToString" id="_ref_8"><a href="https://tc39.es/ecma262/#sec-tostring">ToString</a></emu-xref>(<var>specifier</var>).</li><li><emu-xref aoid="IfAbruptRejectPromise" id="_ref_9"><a href="https://tc39.es/ecma262/#sec-ifabruptrejectpromise">IfAbruptRejectPromise</a></emu-xref>(<var>specifierString</var>, <var>promiseCapability</var>).</li><li><ins>Let <var>moduleRequest</var> be a new <emu-xref href="#sec-modulerequest-record" id="_ref_10"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref> { [[Specifier]]: <var>specifierString</var>, [[Assertions]]: an empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> }.</ins></li><li>Perform !&nbsp;<emu-xref aoid="HostImportModuleDynamically" id="_ref_11"><a href="#sec-hostimportmoduledynamically">HostImportModuleDynamically</a></emu-xref>(<var>referencingScriptOrModule</var>, <del><var>specifierString</var>,</del> <ins><var>moduleRequest</var>,</ins> <var>promiseCapability</var>).</li><li>Return <var>promiseCapability</var>.[[Promise]].</li></ol></emu-alg>

        <ins><emu-grammar><emu-production name="ImportCall" collapsed="">
    <emu-nt><a href="#prod-ImportCall">ImportCall</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="ee392673"><emu-t>import</emu-t><emu-t>(</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-AssignmentExpression">AssignmentExpression</a></emu-nt><emu-t>,</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-AssignmentExpression">AssignmentExpression</a></emu-nt><emu-t optional="">,<emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-t><emu-t>)</emu-t></emu-rhs>
</emu-production></emu-grammar></ins>
        <emu-alg><ol><li>Let <var>referencingScriptOrModule</var> be !&nbsp;<emu-xref aoid="GetActiveScriptOrModule" id="_ref_12"><a href="https://tc39.es/ecma262/#sec-getactivescriptormodule">GetActiveScriptOrModule</a></emu-xref>().</li><li>Let <var>argRef</var> be the result of evaluating <ins>the first</ins> <emu-nt><a href="https://tc39.es/ecma262/#prod-AssignmentExpression">AssignmentExpression</a></emu-nt>.</li><li>Let <var>specifier</var> be ?&nbsp;<emu-xref aoid="GetValue" id="_ref_13"><a href="https://tc39.es/ecma262/#sec-getvalue">GetValue</a></emu-xref>(<var>argRef</var>).</li><li>Let <var>promiseCapability</var> be !&nbsp;<emu-xref aoid="NewPromiseCapability" id="_ref_14"><a href="https://tc39.es/ecma262/#sec-newpromisecapability">NewPromiseCapability</a></emu-xref>(<emu-xref href="#sec-promise-constructor"><a href="https://tc39.es/ecma262/#sec-promise-constructor">%Promise%</a></emu-xref>).</li><li>Let <var>specifierString</var> be <emu-xref aoid="ToString" id="_ref_15"><a href="https://tc39.es/ecma262/#sec-tostring">ToString</a></emu-xref>(<var>specifier</var>).</li><li><emu-xref aoid="IfAbruptRejectPromise" id="_ref_16"><a href="https://tc39.es/ecma262/#sec-ifabruptrejectpromise">IfAbruptRejectPromise</a></emu-xref>(<var>specifierString</var>, <var>promiseCapability</var>).</li><li><ins>Let <var>argRef</var> be the result of evaluating the second <emu-nt><a href="https://tc39.es/ecma262/#prod-AssignmentExpression">AssignmentExpression</a></emu-nt>.</ins></li><li><ins>Let <var>arg</var> be ?&nbsp;<emu-xref aoid="GetValue" id="_ref_17"><a href="https://tc39.es/ecma262/#sec-getvalue">GetValue</a></emu-xref>(<var>argRef</var>).</ins></li><li><ins>If <var>arg</var> is <emu-val>undefined</emu-val>, let <var>assertions</var> be an empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</ins></li><li><ins>Otherwise,</ins><ol><li><ins>Let <var>assertionsObj</var> be ?&nbsp;<emu-xref aoid="Get" id="_ref_18"><a href="https://tc39.es/ecma262/#sec-get-o-p">Get</a></emu-xref>(<var>arg</var>, <emu-val>"assert"</emu-val>).</ins></li><li><ins>Let <var>assertions</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</ins></li><li><ins>Let <var>keys</var> be <emu-xref aoid="EnumerableOwnPropertyNames" id="_ref_19"><a href="https://tc39.es/ecma262/#sec-enumerableownpropertynames">EnumerableOwnPropertyNames</a></emu-xref>(<var>assertionsObj</var>, <emu-const>key</emu-const>).</ins></li><li><ins><emu-xref aoid="IfAbruptRejectPromise" id="_ref_20"><a href="https://tc39.es/ecma262/#sec-ifabruptrejectpromise">IfAbruptRejectPromise</a></emu-xref>(<var>keys</var>, <var>promiseCapability</var>).</ins></li><li><ins>For each String <var>key</var> of <var>keys</var>,</ins><ol><li><ins>Let <var>value</var> be <emu-xref aoid="Get" id="_ref_21"><a href="https://tc39.es/ecma262/#sec-get-o-p">Get</a></emu-xref>(<var>assertionsObj</var>, <var>key</var>).</ins></li><li><ins><emu-xref aoid="IfAbruptRejectPromise" id="_ref_22"><a href="https://tc39.es/ecma262/#sec-ifabruptrejectpromise">IfAbruptRejectPromise</a></emu-xref>(<var>value</var>, <var>promiseCapability</var>).</ins></li><li><ins>Append { [[Key]]: <var>key</var>, [[Value]], <var>value</var> } to <var>assertions</var>.</ins></li></ol></li><li><ins>Sort <var>assertions</var> by the code point order of the [[Key]] of each entry.  NOTE: This sorting is observable only in that hosts are prohibited from distinguishing among assertions by the order they occur in.</ins></li></ol></li><li><ins>Let <var>moduleRequest</var> be a new <emu-xref href="#sec-modulerequest-record" id="_ref_23"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref> { [[Specifier]]: <var>specifierString</var>, [[Assertions]]: <var>assertions</var> }.</ins></li><li>Perform !&nbsp;<emu-xref aoid="HostImportModuleDynamically" id="_ref_24"><a href="#sec-hostimportmoduledynamically">HostImportModuleDynamically</a></emu-xref>(<var>referencingScriptOrModule</var>, <del><var>specifierString</var>,</del> <ins><var>moduleRequest</var>,</ins> <var>promiseCapability</var>).</li><li>Return <var>promiseCapability</var>.[[Promise]].
        </li></ol></emu-alg>
      </emu-clause>
    </emu-clause>

      <emu-clause id="sec-hostresolveimportedmodule" aoid="HostResolveImportedModule">
        <h1><span class="secnum">2.2</span> Runtime Semantics: HostResolveImportedModule ( <var>referencingScriptOrModule</var>, <del><var>specifier</var></del> <ins><var>moduleRequest</var></ins> )</h1>
        <p>HostResolveImportedModule is an implementation-defined abstract operation that provides the concrete <emu-xref href="#sec-abstract-module-records"><a href="https://tc39.es/ecma262/#sec-abstract-module-records">Module Record</a></emu-xref> subclass instance that corresponds to <del>the <emu-nt><a href="https://tc39.es/ecma262/#prod-ModuleSpecifier">ModuleSpecifier</a></emu-nt> String, <var>specifier</var>,</del><ins>the <emu-xref href="#sec-modulerequest-record" id="_ref_25"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref> <var>moduleRequest</var> occurring within the context of the script or module represented by the <emu-xref href="#script-record"><a href="https://tc39.es/ecma262/#script-record">Script Record</a></emu-xref> or <emu-xref href="#sec-abstract-module-records"><a href="https://tc39.es/ecma262/#sec-abstract-module-records">Module Record</a></emu-xref> <var>referencingScriptOrModule</var>. <var>referencingScriptOrModule</var> may also be <emu-val>null</emu-val>, if the resolution is being performed in the context of an <emu-xref href="#sec-import-calls" id="_ref_0"><a href="#sec-import-calls"><code>import()</code></a></emu-xref> expression, and there is no active script or module at that time.</ins></p>

        <emu-note><span class="note">Note</span><div class="note-contents">
          <p>An example of when <var>referencingScriptOrModule</var> can be <emu-val>null</emu-val> is in a web browser host. There, if a user clicks on a control given by</p>

          <pre><code class="html hljs"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"import('./foo.mjs')"</span>&gt;</span>Click me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></code></pre>

          <p>there will be no active script or module at the time the <emu-xref href="#sec-import-calls" id="_ref_1"><a href="#sec-import-calls"><code>import()</code></a></emu-xref> expression runs. More generally, this can happen in any situation where the host pushes execution contexts with <emu-val>null</emu-val> ScriptOrModule components onto the <emu-xref href="#execution-context-stack"><a href="https://tc39.es/ecma262/#execution-context-stack">execution context stack</a></emu-xref>.</p>
        </div></emu-note>

        <p>The implementation of HostResolveImportedModule must conform to the following requirements:</p>
        <ul>
          <li>
            The normal return value must be an instance of a concrete subclass of <emu-xref href="#sec-abstract-module-records"><a href="https://tc39.es/ecma262/#sec-abstract-module-records">Module Record</a></emu-xref>.
          </li>
          <li>
            If a <emu-xref href="#sec-abstract-module-records"><a href="https://tc39.es/ecma262/#sec-abstract-module-records">Module Record</a></emu-xref> corresponding to the pair <var>referencingScriptOrModule</var>, <del><var>specifier</var></del>, <ins><var>moduleRequest</var></ins> does not exist or cannot be created, an exception must be thrown.
          </li>
          <li>
            Each time this operation is called with a specific <var>referencingScriptOrModule</var>, <del><var>specifier</var> pair</del> <ins><var>moduleRequest</var>.[[Specifier]], <var>moduleRequest</var>.[[Assertions]] triple</ins> as arguments it must return the same <emu-xref href="#sec-abstract-module-records"><a href="https://tc39.es/ecma262/#sec-abstract-module-records">Module Record</a></emu-xref> instance if it completes normally.
            <ul>
              <li>
                It is recommended but not required that implementations additionally conform to the following stronger constraint: each time this operation is called with a specific <var>referencingScriptOrModule</var>, <var>moduleRequest</var>.[[Specifier]] pair as arguments it must return the same <emu-xref href="#sec-abstract-module-records"><a href="https://tc39.es/ecma262/#sec-abstract-module-records">Module Record</a></emu-xref> instance if it completes normally.
              </li>
            </ul>
          </li>
          <li>
            <ins><var>moduleRequest</var>.[[Assertions]] must not influence the interpretation of the module or the module specifier; instead, it may be used to determine whether the algorithm completes normally or with an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>.</ins>
          </li>
        </ul>
        <p>Multiple different <var>referencingScriptOrModule</var>, <del><var>specifier</var></del> <ins><var>moduleRequest</var>.[[Specifier]]</ins> pairs may map to the same <emu-xref href="#sec-abstract-module-records"><a href="https://tc39.es/ecma262/#sec-abstract-module-records">Module Record</a></emu-xref> instance. The actual mapping semantic is implementation-defined but typically a normalization process is applied to <var>specifier</var> as part of the mapping process. A typical normalization process would include actions such as alphabetic case folding and expansion of relative and abbreviated path specifiers.</p>

        <emu-note type="editor"><span class="note">Editor's Note</span><div class="note-contents">
          <p>The above text implies that is recommended but not required that hosts do not use <var>moduleRequest</var>.[[Assertions]] as part of the module cache key. In either case, an exception thrown from an import with a given assertion list does not rule out success of another import with the same specifier but a different assertion list.</p>
          <p>Assertions do not affect the contents of the module. Future follow-up proposals may relax this restriction with "evaluator attributes" that would change the contents of the module. There are three possible ways to handle multiple imports of the same module with "evaluator attributes":</p>
          <ul>
            <li><strong>Race</strong> and use the attribute that was requested by the first import. This seems broken--the second usage is ignored.</li>
            <li><strong>Reject</strong> the module graph and don't load if attributes differ. This seems bad for composition--using two unrelated packages together could break, if they load the same module with disagreeing attributes.</li>
            <li><strong>Clone</strong> and make two copies of the module, for the different ways it's transformed. In this case, the attributes would have to be part of the cache key. These semantics would run counter to the intuition that there is just one copy of a module.</li>
          </ul>
          <p>It's possible that one of these three options may make sense for a module load, on a case-by-case basis by attribute, but it's worth careful thought before making this choice.</p>
        </div></emu-note>
      </emu-clause>

      <emu-clause id="sec-hostimportmoduledynamically" aoid="HostImportModuleDynamically">
        <h1><span class="secnum">2.3</span> Runtime Semantics: HostImportModuleDynamically ( <var>referencingScriptOrModule</var>, <del><var>specifier</var>,<del> <ins><var>moduleRequest</var>,</ins> <var>promiseCapability</var> )</del></del></h1>
        <p>HostImportModuleDynamically is an implementation-defined abstract operation that performs any necessary setup work in order to make available the module corresponding to the <del><emu-nt><a href="https://tc39.es/ecma262/#prod-ModuleSpecifier">ModuleSpecifier</a></emu-nt> String, <var>specifier</var>,</del><ins><emu-xref href="#sec-modulerequest-record" id="_ref_26"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref> <var>moduleRequest</var></ins> occurring within the context of the script or module represented by the <emu-xref href="#script-record"><a href="https://tc39.es/ecma262/#script-record">Script Record</a></emu-xref> or <emu-xref href="#sec-abstract-module-records"><a href="https://tc39.es/ecma262/#sec-abstract-module-records">Module Record</a></emu-xref> <var>referencingScriptOrModule</var>. (<var>referencingScriptOrModule</var> may also be <emu-val>null</emu-val>, if there is no active script or module when the <emu-xref href="#sec-import-calls" id="_ref_2"><a href="#sec-import-calls"><code>import()</code></a></emu-xref> expression occurs.) It then performs <emu-xref aoid="FinishDynamicImport" id="_ref_27"><a href="#sec-finishdynamicimport">FinishDynamicImport</a></emu-xref> to finish the dynamic import process.</p>


        <p>The implementation of HostImportModuleDynamically must conform to the following requirements:</p>

        <ul>
          <li>
            The abstract operation must always complete normally with <emu-val>undefined</emu-val>. Success or failure must instead be signaled as discussed below.
          </li>
          <li>
            The host environment must conform to one of the two following sets of requirements:
            <dl>
              <dt>Success path</dt>

              <dd>
                <ul>
                  <li>At some future time, the host environment must perform <emu-xref aoid="FinishDynamicImport" id="_ref_28"><a href="#sec-finishdynamicimport">FinishDynamicImport</a></emu-xref>(<var>referencingScriptOrModule</var>, <del><var>specifier</var>,</del> <ins><var>moduleRequest</var></ins>, <var>promiseCapability</var>, <emu-xref aoid="NormalCompletion" id="_ref_29"><a href="https://tc39.es/ecma262/#sec-normalcompletion">NormalCompletion</a></emu-xref>(<emu-val>undefined</emu-val>)).</li>

                  <li>Any subsequent call to <emu-xref aoid="HostResolveImportedModule" id="_ref_30"><a href="#sec-hostresolveimportedmodule">HostResolveImportedModule</a></emu-xref> after <emu-xref aoid="FinishDynamicImport" id="_ref_31"><a href="#sec-finishdynamicimport">FinishDynamicImport</a></emu-xref> has completed, given the arguments <var>referencingScriptOrModule</var>, and <del><var>specifier</var></del> <ins><var>moduleRequest</var></ins> must complete normally.</li>

                  <li>The completion value of any subsequent call to <emu-xref aoid="HostResolveImportedModule" id="_ref_32"><a href="#sec-hostresolveimportedmodule">HostResolveImportedModule</a></emu-xref> after <emu-xref aoid="FinishDynamicImport" id="_ref_33"><a href="#sec-finishdynamicimport">FinishDynamicImport</a></emu-xref> has completed, given the arguments <var>referencingScriptOrModule</var>, and <del><var>specifier</var>,</del> <ins><var>moduleRequest</var></ins> must be a module which has already been evaluated, i.e. whose Evaluate concrete method has already been called and returned a normal completion.</li>
                </ul>
              </dd>

              <dt>Failure path</dt>

              <dd>
                <ul>
                  <li>At some future time, the host environment must perform <emu-xref aoid="FinishDynamicImport" id="_ref_34"><a href="#sec-finishdynamicimport">FinishDynamicImport</a></emu-xref>(<var>referencingScriptOrModule</var>, <del><var>specifier</var>,</del> <ins><var>moduleRequest</var>,</ins> <var>promiseCapability</var>, an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>), with the <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref> representing the cause of failure.</li>
                </ul>
              </dd>
            </dl>
          </li>
          <li>
            If the host environment takes the success path once for a given <var>referencingScriptOrModule</var>, <del><var>specifier</var>,</del> <ins><var>moduleRequest</var></ins> pair, it must always do so for subsequent calls.
          </li>
          <li>
            The operation must not call <var>promiseCapability</var>.[[Resolve]] or <var>promiseCapability</var>.[[Reject]], but instead must treat <var>promiseCapability</var> as an opaque identifying value to be passed through to <emu-xref aoid="FinishDynamicImport" id="_ref_35"><a href="#sec-finishdynamicimport">FinishDynamicImport</a></emu-xref>.
          </li>
        </ul>

        <p>The actual process performed is implementation-defined, but typically consists of performing whatever I/O operations are necessary to allow <emu-xref aoid="HostResolveImportedModule" id="_ref_36"><a href="#sec-hostresolveimportedmodule">HostResolveImportedModule</a></emu-xref> to synchronously retrieve the appropriate <emu-xref href="#sec-abstract-module-records"><a href="https://tc39.es/ecma262/#sec-abstract-module-records">Module Record</a></emu-xref>, and then calling its Evaluate concrete method. This might require performing similar normalization as <emu-xref aoid="HostResolveImportedModule" id="_ref_37"><a href="#sec-hostresolveimportedmodule">HostResolveImportedModule</a></emu-xref> does.</p>
      </emu-clause>

      <emu-clause id="sec-finishdynamicimport" aoid="FinishDynamicImport">
        <h1><span class="secnum">2.4</span> Runtime Semantics: FinishDynamicImport ( <var>referencingScriptOrModule</var>, <del><var>specifier</var>,</del> <ins><var>moduleRequest</var>,</ins> <var>promiseCapability</var>, <var>completion</var> )</h1>
        <p>The abstract operation FinishDynamicImport takes arguments <var>referencingScriptOrModule</var>, <del><var>specifier</var>,</del> <ins><var>moduleRequest</var> (a <emu-xref href="#sec-modulerequest-record" id="_ref_38"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref>),</ins> <var>promiseCapability</var>, and <var>completion</var>. FinishDynamicImport completes the process of a dynamic import originally started by an <emu-xref href="#sec-import-calls" id="_ref_3"><a href="#sec-import-calls"><code>import()</code></a></emu-xref> call, resolving or rejecting the promise returned by that call as appropriate according to <var>completion</var>. It is performed by host environments as part of <emu-xref aoid="HostImportModuleDynamically" id="_ref_39"><a href="#sec-hostimportmoduledynamically">HostImportModuleDynamically</a></emu-xref>. It performs the following steps when called:</p>


        <emu-alg><ol><li>If <var>completion</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then perform !&nbsp;<emu-xref aoid="Call" id="_ref_40"><a href="https://tc39.es/ecma262/#sec-call">Call</a></emu-xref>(<var>promiseCapability</var>.[[Reject]], <emu-val>undefined</emu-val>, « <var>completion</var>.[[Value]] »).</li><li>Else,<ol><li><emu-xref href="#assert"><a href="https://tc39.es/ecma262/#assert">Assert</a></emu-xref>: <var>completion</var> is a normal completion and <var>completion</var>.[[Value]] is <emu-val>undefined</emu-val>.</li><li>Let <var>moduleRecord</var> be !&nbsp;<emu-xref aoid="HostResolveImportedModule" id="_ref_41"><a href="#sec-hostresolveimportedmodule">HostResolveImportedModule</a></emu-xref>(<var>referencingScriptOrModule</var>, <del><var>specifier</var>,</del> <ins><var>moduleRequest</var></ins>).</li><li><emu-xref href="#assert"><a href="https://tc39.es/ecma262/#assert">Assert</a></emu-xref>: Evaluate has already been invoked on <var>moduleRecord</var> and successfully completed.</li><li>Let <var>namespace</var> be <emu-xref aoid="GetModuleNamespace" id="_ref_42"><a href="https://tc39.es/ecma262/#sec-getmodulenamespace">GetModuleNamespace</a></emu-xref>(<var>moduleRecord</var>).</li><li>If <var>namespace</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, perform !&nbsp;<emu-xref aoid="Call" id="_ref_43"><a href="https://tc39.es/ecma262/#sec-call">Call</a></emu-xref>(<var>promiseCapability</var>.[[Reject]], <emu-val>undefined</emu-val>, « <var>namespace</var>.[[Value]] »).</li><li>Else, perform !&nbsp;<emu-xref aoid="Call" id="_ref_44"><a href="https://tc39.es/ecma262/#sec-call">Call</a></emu-xref>(<var>promiseCapability</var>.[[Resolve]], <emu-val>undefined</emu-val>, « <var>namespace</var>.[[Value]] »).</li></ol></li></ol></emu-alg>
      </emu-clause>

  <emu-clause id="sec-assert-clause-early-errors">
    <h1><span class="secnum">2.5</span> Static Semantics: Early Errors</h1>
    <emu-grammar><emu-production name="AssertClause" collapsed="">
    <emu-nt><a href="#prod-AssertClause">AssertClause</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="89f92a71"><emu-t>assert</emu-t><emu-t>{</emu-t><emu-nt id="_ref_75"><a href="#prod-AssertEntries">AssertEntries</a></emu-nt><emu-t optional="">,<emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-t><emu-t>}</emu-t></emu-rhs>
</emu-production></emu-grammar>
    <ul>
      <li>It is a Syntax Error if <emu-xref aoid="AssertClauseToAssertions" id="_ref_45"><a href="#sec-assert-clause-to-assertions">AssertClauseToAssertions</a></emu-xref> of <emu-nt id="_ref_76"><a href="#prod-AssertClause">AssertClause</a></emu-nt> has two entries <var>a</var> and <var>b</var> such that <var>a</var>.[[Key]] is <var>b</var>.[[Key]].</li>
    </ul>
  </emu-clause>

  <emu-clause id="sec-assert-clause-to-assertions" aoid="AssertClauseToAssertions">
    <h1><span class="secnum">2.6</span> Runtime Semantics: AssertClauseToAssertions</h1>
    <emu-grammar><emu-production name="AssertClause" collapsed="">
    <emu-nt><a href="#prod-AssertClause">AssertClause</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="89f92a71"><emu-t>assert</emu-t><emu-t>{</emu-t><emu-nt id="_ref_77"><a href="#prod-AssertEntries">AssertEntries</a></emu-nt><emu-t optional="">,<emu-mods><emu-opt>opt</emu-opt></emu-mods></emu-t><emu-t>}</emu-t></emu-rhs>
</emu-production></emu-grammar>
    <emu-alg><ol><li>Let <var>assertions</var> be <emu-xref aoid="AssertClauseToAssertions" id="_ref_46"><a href="#sec-assert-clause-to-assertions">AssertClauseToAssertions</a></emu-xref> of <emu-nt id="_ref_78"><a href="#prod-AssertEntries">AssertEntries</a></emu-nt>.</li><li>Sort <var>assertions</var> by the code point order of the [[Key]] of each entry.  NOTE: This sorting is observable only in that hosts are prohibited from distinguishing among assertions by the order they occur in.</li><li>Return <var>assertions</var>.</li></ol></emu-alg>

    <emu-grammar><emu-production name="AssertEntries" collapsed="">
    <emu-nt><a href="#prod-AssertEntries">AssertEntries</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="4aef607e"><emu-nt id="_ref_79"><a href="#prod-AssertionKey">AssertionKey</a></emu-nt><emu-t>:</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-StringLiteral">StringLiteral</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
    <emu-alg><ol><li>Let <var>entry</var> be a <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> { [[Key]]: <emu-xref aoid="AssertClauseToAssertions" id="_ref_47"><a href="#sec-assert-clause-to-assertions">AssertClauseToAssertions</a></emu-xref> of <emu-nt id="_ref_80"><a href="#prod-AssertionKey">AssertionKey</a></emu-nt>, [[Value]]: StringValue of <emu-nt><a href="https://tc39.es/ecma262/#prod-StringLiteral">StringLiteral</a></emu-nt> }.</li><li>Return a new <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> containing the single element, <var>entry</var>.</li></ol></emu-alg>

    <emu-grammar><emu-production name="AssertEntries" collapsed="">
    <emu-nt><a href="#prod-AssertEntries">AssertEntries</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="2e83f2a2"><emu-nt id="_ref_81"><a href="#prod-AssertionKey">AssertionKey</a></emu-nt><emu-t>:</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-StringLiteral">StringLiteral</a></emu-nt><emu-t>,</emu-t><emu-nt id="_ref_82"><a href="#prod-AssertEntries">AssertEntries</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
    <emu-alg><ol><li>Let <var>entry</var> be a <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> { [[Key]]: <emu-xref aoid="AssertClauseToAssertions" id="_ref_48"><a href="#sec-assert-clause-to-assertions">AssertClauseToAssertions</a></emu-xref> of <emu-nt id="_ref_83"><a href="#prod-AssertionKey">AssertionKey</a></emu-nt>, [[Value]]: StringValue of <emu-nt><a href="https://tc39.es/ecma262/#prod-StringLiteral">StringLiteral</a></emu-nt> }.</li><li>Let <var>rest</var> be <emu-xref aoid="AssertClauseToAssertions" id="_ref_49"><a href="#sec-assert-clause-to-assertions">AssertClauseToAssertions</a></emu-xref> of <emu-nt id="_ref_84"><a href="#prod-AssertEntries">AssertEntries</a></emu-nt>.</li><li>Return a new <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> containing <var>entry</var> followed by the entries of <var>rest</var>.</li></ol></emu-alg>

    <emu-grammar><emu-production name="AssertionKey" collapsed="">
    <emu-nt><a href="#prod-AssertionKey">AssertionKey</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="0ebb31e2"><emu-nt><a href="https://tc39.es/ecma262/#prod-IdentifierName">IdentifierName</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
    <emu-alg><ol><li>Return the StringValue of <emu-nt><a href="https://tc39.es/ecma262/#prod-IdentifierName">IdentifierName</a></emu-nt>.</li></ol></emu-alg>

    <emu-grammar><emu-production name="AssertionKey" collapsed="">
    <emu-nt><a href="#prod-AssertionKey">AssertionKey</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="5c74e54d"><emu-nt><a href="https://tc39.es/ecma262/#prod-StringLiteral">StringLiteral</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
    <emu-alg><ol><li>Return the StringValue of <emu-nt><a href="https://tc39.es/ecma262/#prod-StringLiteral">StringLiteral</a></emu-nt>.</li></ol></emu-alg>
  </emu-clause>

      <emu-clause id="sec-modulerequest-record">
        <h1><span class="secnum">2.7</span> ModuleRequest Records</h1>

        <p>A <dfn>ModuleRequest Record</dfn> represents the request to import a module with given import assertions. It consists of the following fields:</p>
        <emu-table id="table-cyclic-module-fields" caption="ModuleRequest Record fields"><figure><figcaption>Table 1: <emu-xref href="#sec-modulerequest-record" id="_ref_50"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref> fields</figcaption>
          <table>
            <tbody>
              <tr>
                <th>
                  Field Name
                </th>
                <th>
                  Value Type
                </th>
                <th>
                  Meaning
                </th>
              </tr>
              <tr>
                <td>
                  [[Specifier]]
                </td>
                <td>
                  String
                </td>
                <td>
                  The module specifier
                </td>
              </tr>
              <tr>
                <td>
                  [[Assertions]]
                </td>
                <td>
                  a <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> of Records { [[Key]]: a String, [[Value]]: a String }
                </td>
                <td>
                  The import assertions
                </td>
              </tr>
            </tbody>
          </table>
        </figure></emu-table>

        <emu-note type="editor"><span class="note">Editor's Note</span><div class="note-contents">In general, this proposal replaces places where module specifiers are passed around with ModuleRequest Records. For example, several syntax-directed operations, such as ModuleRequests produce Lists of ModuleRequest Records rather than Lists of Strings which are interpreted as module specifiers. Some algorithms like ImportEntries and ImportEntriesForModule pass around ModuleRequest Records rather than Strings, in a way which doesn't require any particular textual change. Additionally, record fields in Cyclic Module Records and Source Text Module Records which contained Lists of Strings are replaced by Lists of ModuleRequest Records, as indicated above.</div></emu-note>
      </emu-clause>

        <emu-table id="table-cyclic-module-fields" caption="Additional Fields of Cyclic Module Records"><figure><figcaption>Table 2: Additional Fields of Cyclic Module Records</figcaption>
          <table>
            <tbody>
              <tr>
                <th>
                  Field Name
                </th>
                <th>
                  Value Type
                </th>
                <th>
                  Meaning
                </th>
              </tr>
              <tr>
                <td>
                  [[Status]]
                </td>
                <td>
                  <emu-const>unlinked</emu-const> | <emu-const>linking</emu-const> | <emu-const>linked</emu-const> | <emu-const>evaluating</emu-const> | <emu-const>evaluated</emu-const>
                </td>
                <td>
                  Initially <emu-const>unlinked</emu-const>. Transitions to <emu-const>linking</emu-const>, <emu-const>linked</emu-const>, <emu-const>evaluating</emu-const>, <emu-const>evaluated</emu-const> (in that order) as the module progresses throughout its lifecycle.
                </td>
              </tr>
              <tr>
                <td>
                  [[EvaluationError]]
                </td>
                <td>
                  An <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref> | <emu-val>undefined</emu-val>
                </td>
                <td>
                  A completion of type <emu-const>throw</emu-const> representing the exception that occurred during evaluation.  <emu-val>undefined</emu-val> if no exception occurred or if [[Status]] is not <emu-const>evaluated</emu-const>.
                </td>
              </tr>
              <tr>
                <td>
                  [[DFSIndex]]
                </td>
                <td>
                  <emu-xref href="#integer"><a href="https://tc39.es/ecma262/#integer">Integer</a></emu-xref> | <emu-val>undefined</emu-val>
                </td>
                <td>
                  Auxiliary field used during Link and Evaluate only.
                  If [[Status]] is <emu-const>linking</emu-const> or <emu-const>evaluating</emu-const>, this nonnegative number records the point at which the module was first visited during the ongoing depth-first traversal of the dependency graph.
                </td>
              </tr>
              <tr>
                <td>
                  [[DFSAncestorIndex]]
                </td>
                <td>
                  <emu-xref href="#integer"><a href="https://tc39.es/ecma262/#integer">Integer</a></emu-xref> | <emu-val>undefined</emu-val>
                </td>
                <td>
                  Auxiliary field used during Link and Evaluate only. If [[Status]] is <emu-const>linking</emu-const> or <emu-const>evaluating</emu-const>, this is either the module's own [[DFSIndex]] or that of an "earlier" module in the same strongly connected component.
                </td>
              </tr>
              <tr>
                <td>
                  [[RequestedModules]]
                </td>
                <td>
                  <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> of <del>String</del><ins><emu-xref href="#sec-modulerequest-record" id="_ref_51"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref></ins>
                </td>
                <td>
                  A <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> of all the <emu-nt><a href="https://tc39.es/ecma262/#prod-ModuleSpecifier">ModuleSpecifier</a></emu-nt> strings <ins>and import assertions</ins> used by the module represented by this record to request the importation of a module. The <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> is source code occurrence ordered.
                </td>
              </tr>
            </tbody>
          </table>
        </figure></emu-table>

        <p>An <dfn id="importentry-record">ImportEntry Record</dfn> is a <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> that digests information about a single declarative import. Each <emu-xref href="#importentry-record" id="_ref_52"><a href="#importentry-record">ImportEntry Record</a></emu-xref> has the fields defined in <emu-xref href="#table-39" id="_ref_4"><a href="#table-39">Table 3</a></emu-xref>:</p>
        <emu-table id="table-39" caption="ImportEntry Record Fields"><figure><figcaption>Table 3: <emu-xref href="#importentry-record" id="_ref_53"><a href="#importentry-record">ImportEntry Record</a></emu-xref> Fields</figcaption>
          <table>
            <tbody>
            <tr>
              <th>
                Field Name
              </th>
              <th>
                Value Type
              </th>
              <th>
                Meaning
              </th>
            </tr>
            <tr>
              <td>
                [[ModuleRequest]]
              </td>
              <td>
                <del>String</del>
                <ins><emu-xref href="#sec-modulerequest-record" id="_ref_54"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref></ins>
              </td>
              <td>
                <del>String value of the <emu-nt><a href="https://tc39.es/ecma262/#prod-ModuleSpecifier">ModuleSpecifier</a></emu-nt> of the <emu-nt id="_ref_85"><a href="#prod-ImportDeclaration">ImportDeclaration</a></emu-nt>.</del>
                <ins><emu-xref href="#sec-modulerequest-record" id="_ref_55"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref> representing the <emu-nt><a href="https://tc39.es/ecma262/#prod-ModuleSpecifier">ModuleSpecifier</a></emu-nt> and import assertions of the <emu-nt id="_ref_86"><a href="#prod-ImportDeclaration">ImportDeclaration</a></emu-nt>.</ins>
              </td>
            </tr>
            <tr>
              <td>
                [[ImportName]]
              </td>
              <td>
                String
              </td>
              <td>
                The name under which the desired binding is exported by the module identified by [[ModuleRequest]]. The value <emu-val>"*"</emu-val> indicates that the import request is for the target module's namespace object.
              </td>
            </tr>
            <tr>
              <td>
                [[LocalName]]
              </td>
              <td>
                String
              </td>
              <td>
                The name that is used to locally access the imported value from within the importing module.
              </td>
            </tr>
            </tbody>
          </table>
        </figure></emu-table>

      <emu-clause id="sec-static-semantics-modulerequests">
        <h1><span class="secnum">2.8</span> Static Semantics: ModuleRequests</h1>
        <emu-see-also-para op="ModuleRequests"></emu-see-also-para>
        <emu-grammar><emu-production name="ImportDeclaration" collapsed="">
    <emu-nt><a href="#prod-ImportDeclaration">ImportDeclaration</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="1a51d4c5"><emu-t>import</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-ImportClause">ImportClause</a></emu-nt><emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt><emu-t>;</emu-t></emu-rhs>
</emu-production></emu-grammar>
        <emu-alg><ol><li><del>Return ModuleRequests of <emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt>.</del></li><li><ins>Let <var>specifier</var> be StringValue of the <emu-nt><a href="https://tc39.es/ecma262/#prod-StringLiteral">StringLiteral</a></emu-nt> contained in <emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt>.</ins></li><li><ins>Return a <emu-xref href="#sec-modulerequest-record" id="_ref_56"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref> { [[Specifer]]: <var>specifier</var>, [[Assertions]]: an empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> }.</ins></li></ol></emu-alg>
        <emu-grammar><emu-production name="ImportDeclaration" collapsed="">
    <emu-nt><a href="#prod-ImportDeclaration">ImportDeclaration</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="07ae820f"><emu-t>import</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-ImportClause">ImportClause</a></emu-nt><emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt><emu-nt id="_ref_87"><a href="#prod-AssertClause">AssertClause</a></emu-nt><emu-t>;</emu-t></emu-rhs>
</emu-production></emu-grammar>
        <emu-alg><ol><li><ins>Let <var>specifier</var> be StringValue of the <emu-nt><a href="https://tc39.es/ecma262/#prod-StringLiteral">StringLiteral</a></emu-nt> contained in <emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt>.</ins></li><li><ins>Let <var>assertions</var> be <emu-xref aoid="AssertClauseToAssertions" id="_ref_57"><a href="#sec-assert-clause-to-assertions">AssertClauseToAssertions</a></emu-xref> of <emu-nt id="_ref_88"><a href="#prod-AssertClause">AssertClause</a></emu-nt>.</ins></li><li><ins>Return a <emu-xref href="#sec-modulerequest-record" id="_ref_58"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref> { [[Specifer]]: <var>specifier</var>, [[Assertions]]: <var>assertions</var> }.</ins></li></ol></emu-alg>
        <emu-grammar><emu-production name="Module" collapsed="" id="prod-Module">
    <emu-nt><a href="#prod-Module">Module</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="37b9c04c"><emu-gann>[empty]</emu-gann></emu-rhs>
</emu-production></emu-grammar>
        <emu-alg><ol><li>Return a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li></ol></emu-alg>
        <emu-grammar><emu-production name="ModuleItemList" collapsed="" id="prod-ModuleItemList">
    <emu-nt><a href="#prod-ModuleItemList">ModuleItemList</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="029ec31e"><emu-nt id="_ref_89"><a href="#prod-ModuleItem">ModuleItem</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
        <emu-alg><ol><li>Return ModuleRequests of <emu-nt id="_ref_90"><a href="#prod-ModuleItem">ModuleItem</a></emu-nt>.</li></ol></emu-alg>
        <emu-grammar><emu-production name="ModuleItemList" collapsed="">
    <emu-nt><a href="#prod-ModuleItemList">ModuleItemList</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="75ddb725"><emu-nt id="_ref_91"><a href="#prod-ModuleItemList">ModuleItemList</a></emu-nt><emu-nt id="_ref_92"><a href="#prod-ModuleItem">ModuleItem</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
        <emu-alg><ol><li>Let <var>moduleNames</var> be ModuleRequests of <emu-nt id="_ref_93"><a href="#prod-ModuleItemList">ModuleItemList</a></emu-nt>.</li><li>Let <var>additionalNames</var> be ModuleRequests of <emu-nt id="_ref_94"><a href="#prod-ModuleItem">ModuleItem</a></emu-nt>.</li><li>Append to <var>moduleNames</var> each element of <var>additionalNames</var> <del>that is not already an element of <var>moduleNames</var></del>.</li><li>Return <var>moduleNames</var>.</li></ol></emu-alg>
        <emu-note type="editor"><span class="note">Editor's Note</span><div class="note-contents">Deletion of duplicates is an unnecessary "spec optimization" that would be more complicated to explain in terms of examining import assertion records, and can be simply removed.</div></emu-note>
        <emu-grammar><emu-production name="ModuleItem" collapsed="" id="prod-ModuleItem">
    <emu-nt><a href="#prod-ModuleItem">ModuleItem</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="d791d1c9"><emu-nt><a href="https://tc39.es/ecma262/#prod-StatementListItem">StatementListItem</a></emu-nt></emu-rhs>
</emu-production></emu-grammar>
        <emu-alg><ol><li>Return a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li></ol></emu-alg>
        <emu-grammar><emu-production name="ExportDeclaration" collapsed="">
    <emu-nt><a href="#prod-ExportDeclaration">ExportDeclaration</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="e0a40575"><emu-t>export</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-ExportFromClause">ExportFromClause</a></emu-nt><emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt><emu-t>;</emu-t></emu-rhs>
</emu-production></emu-grammar>
        <emu-alg><ol><li><del>Return ModuleRequests of <emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt>.</del></li><li><ins>Let <var>specifier</var> be StringValue of the <emu-nt><a href="https://tc39.es/ecma262/#prod-StringLiteral">StringLiteral</a></emu-nt> contained in <emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt>.</ins></li><li><ins>Return a <emu-xref href="#sec-modulerequest-record" id="_ref_59"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref> { [[Specifer]]: <var>specifier</var>, [[Assertions]]: an empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> }.</ins></li></ol></emu-alg>
        <emu-grammar><emu-production name="ExportDeclaration" collapsed="">
    <emu-nt><a href="#prod-ExportDeclaration">ExportDeclaration</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="509d3740"><emu-t>export</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-ExportFromClause">ExportFromClause</a></emu-nt><emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt><emu-nt id="_ref_95"><a href="#prod-AssertClause">AssertClause</a></emu-nt><emu-t>;</emu-t></emu-rhs>
</emu-production></emu-grammar>
        <emu-alg><ol><li><ins>Let <var>specifier</var> be StringValue of the <emu-nt><a href="https://tc39.es/ecma262/#prod-StringLiteral">StringLiteral</a></emu-nt> contained in <emu-nt><a href="https://tc39.es/ecma262/#prod-FromClause">FromClause</a></emu-nt>.</ins></li><li><ins>Let <var>assertions</var> be <emu-xref aoid="AssertClauseToAssertions" id="_ref_60"><a href="#sec-assert-clause-to-assertions">AssertClauseToAssertions</a></emu-xref> of <emu-nt id="_ref_96"><a href="#prod-AssertClause">AssertClause</a></emu-nt>.</ins></li><li><ins>Return a <emu-xref href="#sec-modulerequest-record" id="_ref_61"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref> { [[Specifer]]: <var>specifier</var>, [[Assertions]]: <var>assertions</var> }.</ins></li></ol></emu-alg>
        <emu-grammar><emu-production name="ExportDeclaration">
    <emu-nt><a href="#prod-ExportDeclaration">ExportDeclaration</a></emu-nt><emu-geq>:</emu-geq><emu-rhs a="2762c7fe"><emu-t>export</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-NamedExports">NamedExports</a></emu-nt><emu-t>;</emu-t></emu-rhs>
    <emu-rhs a="6c6de801"><emu-t>export</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-VariableStatement">VariableStatement</a></emu-nt></emu-rhs>
    <emu-rhs a="828f5ae3"><emu-t>export</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-Declaration">Declaration</a></emu-nt></emu-rhs>
    <emu-rhs a="71d1417e"><emu-t>export</emu-t><emu-t>default</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-HoistableDeclaration">HoistableDeclaration</a></emu-nt></emu-rhs>
    <emu-rhs a="c3c3cb8d"><emu-t>export</emu-t><emu-t>default</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-ClassDeclaration">ClassDeclaration</a></emu-nt></emu-rhs>
    <emu-rhs a="e1fe9c4f"><emu-t>export</emu-t><emu-t>default</emu-t><emu-nt><a href="https://tc39.es/ecma262/#prod-AssignmentExpression">AssignmentExpression</a></emu-nt><emu-t>;</emu-t></emu-rhs>
</emu-production></emu-grammar>
        <emu-alg><ol><li>Return a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li></ol></emu-alg>
      </emu-clause>
</emu-clause>

<emu-annex id="sec-host-integration">
  <h1><span class="secnum">A</span> Sample host integration: The Web embedding</h1>

  <p>The import assertions proposal is intended to give key information about how modules are interpreted to hosts. For the Web embedding and environments which aim to be similar to it, the string is interpreted as the "module type". This is not the primary way the module type is determined (which, on the Web, would be the MIME type, and in other environments may be the file extension), but rather a secondary check which is required to pass for the module graph to load.</p>

  <p>In the Web embedding, the following changes would be made to the HTML specification for import assertions:</p>

  <ul>
    <li>The <a href="https://html.spec.whatwg.org/#module-script">module script</a> would have an additional item, which would be the module type, as a string (e.g., <emu-val>"json"</emu-val>), or <emu-val>undefined</emu-val> for a JavaScript module.</li>
    <li><emu-xref aoid="HostResolveImportedModule" id="_ref_62"><a href="#sec-hostresolveimportedmodule">HostResolveImportedModule</a></emu-xref> and <emu-xref aoid="HostImportModuleDynamically" id="_ref_63"><a href="#sec-hostimportmoduledynamically">HostImportModuleDynamically</a></emu-xref> would take a <emu-xref href="#sec-modulerequest-record" id="_ref_64"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref> parameter in place of a specifier string, which would be passed down through several <emu-xref href="#sec-algorithm-conventions-abstract-operations"><a href="https://tc39.es/ecma262/#sec-algorithm-conventions-abstract-operations">abstract operations</a></emu-xref> to reach the <a href="https://html.spec.whatwg.org/#fetch-a-single-module-script">fetch a single module script</a> algorithm. Somewhere near the entrypoint, if the <emu-xref href="#sec-modulerequest-record" id="_ref_65"><a href="#sec-modulerequest-record">ModuleRequest Record</a></emu-xref>'s [[Assertions]] field has an entry <var>entry</var> such that <var>entry</var>.[[Key]] is <emu-val>"type"</emu-val>, then let <var>type</var> be <var>entry</var>.[[Value]]; otherwise let <var>type</var> be <emu-val>undefined</emu-val>. If the type is invalid, then an exception is thrown and module loading fails. Otherwise, this will equal the module type, if the module can be successfully fetched with a matching MIME type.</li>
    <li>In the <a href="https://html.spec.whatwg.org/#fetch-the-descendants-of-a-module-script">fetch the descendents of a module script</a> algorithm, when iterating over [[RequestedModules]], the elements are ModuleRequest Records rather than just specifier strings; these Records is passed on to the internal module script graph fetching procedure (which sends it to "fetch a single module script". Other usage sites of [[RequestedModules]] ignore the assertion.</li>
    <li>"Fetch a single module script" would check the assertion in two places:
      <ul>
        <li>If the module is found in the module map, then <var>type</var> is checked against the module script's type field. If they differ, then an exception is thrown and module loading fails.</li>
        <li>When a new module is fetched, before writing it into the module map, the MIME type is checked to ensure that it matches <var>type</var>. (Note that the interpretation of the module is still driven by the MIME type, but once the MIME type is established, this is checked against the <var>type</var>.) If they differ, then an exception is thrown and module loading fails. The <var>type</var> is written into the module script as the type.</li>
      </ul>
    </li>
  </ul>

  <p>Note that the module map remains keyed by the absolute URL; the <var>type</var> is not part of the module map key, and initially, no other import assertions are supported, so they are also not present.</p>
</emu-annex>
</div></body>